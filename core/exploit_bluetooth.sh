#!/bin/bash

RED='\033[1;31m'
GREEN='\033[1;32m'
YELLOW='\033[1;33m'
CYAN='\033[1;36m'
BLUE='\033[1;34m'
NC='\033[0m'

echo "[INFO] Module 5 launched by $USER at $(date)" >> logs/bluetooth.log

bluetooth_banner() {
  clear
  echo -e "${CYAN}"
  echo "╔═════════════════════════════════════════════════╗"
  echo "          Bluetooth Exploitation Toolkit 🔐        "
  echo "╚═════════════════════════════════════════════════╝"
  echo -e "${NC}"
}

bluetooth_menu() {
  bluetooth_banner
  echo -e "${BLUE}Bluetooth Exploitation Toolkit:${NC}"
  echo " 1) 🔍  Bluetooth Recon (scan & identify nearby devices)"
  echo " 2) 🧬  Vulnerability Scanner (stack fingerprinting, CVE checks)"
  echo " 3) 💉  BlueDucky HID Injection (keyboard payloads)"
  echo " 4) 🔓  Pairing Bypass & Spoof (tools & PoCs)"
  echo " 5) 🛠️   Classic Attacks (L2CAP, DoS, BT-Sploit)"
  echo " 6) 🧑‍🔧  Adapter Configuration (MAC/Name Spoofer, Interface Tools)"
  echo " 7) 📜  View Bluetooth Logs"
  echo " 8) ⬅️  Return to Main Menu"

  echo
  # shellcheck disable=SC2162
  read -p "Choose an option [1-8]: " bt_choice

  case $bt_choice in
    1) bash core/bluetooth/recon.sh ;;
    2) bash core/bluetooth/vuln_scanner.sh ;;
    3) bash core/bluetooth/blueducky.sh ;;
    4) bash core/bluetooth/pairing_bypass.sh ;;
    5) bash core/bluetooth/classic_attacks.sh ;;
    6) bash core/bluetooth/adapter_config.sh ;; # DONE
    7) cat logs/bluetooth.log | less ;;
    8) bash LazySuzann.sh ;;
    *) echo -e "${RED}Invalid selection, try again.${NC}"; sleep 1; bluetooth_menu ;;
  esac
}

bluetooth_menu